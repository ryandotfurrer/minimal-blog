---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
  (a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf(),
);
---

<BaseLayout>
  <main class="space-y-4">
    <h1 class="py-8">Blog</h1>
    <ul class="space-y-4">
      {
        posts.map(post => (
          <a
            class="block rounded-lg outline-zinc-200 hover:bg-zinc-100 hover:outline dark:outline-zinc-700 dark:hover:bg-zinc-800"
            href={`/blog/${post.slug}/`}
          >
            <span class="sr-only">Read more about {post.data.title}</span>
            <li class="group space-y-2 rounded-lg p-4">
              <h4 class="text-zinc-500 transition-colors group-hover:text-zinc-900 dark:text-zinc-400 dark:group-hover:text-zinc-50">
                {post.data.title}
              </h4>
              <p class="text-xs">
                <FormattedDate date={post.data.pubDate} />
              </p>
              <p class="line-clamp-2">{post.data.description}</p>
              <p class="text-sm transition-colors group-hover:text-zinc-900 dark:group-hover:text-zinc-50">
                Read more
                <span class="ml-1 transition-all group-hover:pl-1">-></span>
              </p>
            </li>
          </a>
        ))
      }
    </ul>
  </main>
</BaseLayout>
